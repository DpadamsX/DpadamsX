CREATE OR REPLACE FUNCTION api.hour_number(dts timestamptz)  RETURNS pg_catalog.int2 AS$BODY$/* day numbers are 0-6 and hours are 0-23 in postgres. this function shifts those to 1-7 and 1-24,   and gives you the hour-in-the-week result. so 12:30 am sunday night is 1, 1:00 sunday night is 2	 1:00 monday night is 25, and so on. */select ((extract(dow from dts) + 1) * 24 +	   (extract (hour from dts) + 1)) ::int2$BODY$  LANGUAGE sql STABLE;ALTER function api.hour_number (timestamptz)	OWNER TO user_bender;