CREATE OR REPLACE FUNCTION api.push_log_sum_since (since_dts timestamptz)	RETURNS TABLE(		days_ago int8,		table_name extensions.citext,		server_name extensions.citext,		push_sum int8)AS $BODY$DECLARE-- Subtract two timestamptz values, get an interval, pull out just the days.   days_ago bigint := date_part('day', now()::timestamptz - since_dts)::bigint;BEGINRETURN QUERY    SELECT days_ago,           ib_table_name as table_name,           data_file_info.server_name_ as server_name,           sum(push_log.records_count) as push_sum      FROM ascendco.push_log      JOIN ascendco.data_file_info on (data_file_info.id = push_log.data_file_id)     WHERE push_log.push_dts >= since_dts  GROUP BY ib_table_name,           data_file_info.server_name_  ORDER BY ib_table_name,           data_file_info.server_name_           ;END;$BODY$  LANGUAGE plpgsql STABLE SECURITY DEFINER  COST 100  ROWS 1000;ALTER FUNCTION api.push_log_sum_since (timestamptz)	OWNER TO user_bender;