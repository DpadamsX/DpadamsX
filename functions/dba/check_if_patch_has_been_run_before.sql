CREATE OR REPLACE FUNCTION dba.check_if_patch_has_been_run_before (patch_name_in text) RETURNS booleanAS $BODY$DECLARE  row_count int8;BEGINSELECT count(*) INTO row_count  FROM patch_log WHERE patch_name = patch_name_in;IF (row_count = 0) THEN  RETURN false;ELSE  RAISE EXCEPTION USING	 message = 'Patch has been run before',	 hint = 'Patches should be run in order, and may not be reapplied.',	 errcode = 'KC001'; -- Custom code for 'Patch has been run before.'END IF;END;$BODY$  LANGUAGE plpgsql VOLATILE  COST 100;ALTER FUNCTION dba.check_if_patch_has_been_run_before (text)	OWNER TO user_bender;