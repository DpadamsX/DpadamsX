CREATE OR REPLACE FUNCTION ""("table_name" text, "field_name" text, "frequency_threshold" int4, "value_threshold" int4)  RETURNS TABLE("value_" int4, "frequency_percentile" int4, "value_percentile" int4) AS $BODY$BEGIN    RETURN QUERY EXECUTE       'with frequency_counts as (   select ' ||  field_name || '::INT as value_,          count(*) as frequency					              from ' || table_name || '										  where ' ||  field_name || ' > 0					 	      group by 1 	      order by 2),		frequency_percentiles as (		   select *,         ntile(100) over (order by frequency asc) as frequency_percentile,         ntile(100) over (order by value_ asc) as value_percentile	  from frequency_counts) select value_,       frequency_percentile,       value_percentile         from frequency_percentiles     where frequency_percentile < ' || frequency_threshold || '  and         value_ >          (select value_           from frequency_counts          where value_percentile > ' || value_threshold || '          limit 1) order by 1,2,3';    END;$BODY$  LANGUAGE plpgsql VOLATILE  COST 100  ROWS 1000;  