DROP VIEW IF EXISTS api.print_job_domo;CREATE VIEW api.print_job_domo ASSELECT-- Key values and lookups    print_job.id                                               AS "ID",    hsys.name_                                                 AS "HsysName",    facility.name_                                             AS "FacilityName",-- Print job details    print_job.processing_time_ms                               AS "ProcessingTimeMS",    print_job.close_print_job_ms                               AS "ClosePrintJobMS",    print_job.marked_for_deletion                              AS "MarkedForDeletion",    print_job.mode_                                            AS "Mode",    print_job.type_                                            AS "Type",    print_job.status                                           AS "Status",    print_job.error_info                                       AS "ErrorInfo",    print_job.created_by                                       AS "CreatedBy",    print_job.printer_name                                     AS "PrinterName",    print_job.network_printer_name                             AS "NetworkPrintName",    print_job.server_name_                                     AS "ServerName",    print_job.created_dts                                      AS "Created_DTS",    print_job.created_local_dts                                AS "Created_Local",-- Extended date/time columns: created_dts    created_dts_calendar.date_actual                           AS "Created_Date",    created_dts_calendar.date_actual                           AS "CreatedDate",    created_dts_calendar.day_of_week_usa                       AS "Created_DayOfWeek",    created_dts_calendar.day_name_abbreviated                  AS "Created_DayName",    created_dts_calendar.week_of_year_fiscal_name              AS "Created_FiscalWeek",   --  Week 24 2020    created_dts_calendar.week_of_year_fiscal                   AS "Created_FiscalWeekNo", --  2020-24    created_dts_calendar.month_actual                          AS "Created_MonthNo",    created_dts_calendar.month_actual_name_abbreviated         AS "Created_MonthName",    created_dts_calendar.month_fiscal                          AS "Created_FiscalMonthNo",    created_dts_calendar.month_fiscal_name_abbreviated         AS "Created_FiscalMonthName",    to_char(created_dts_calendar.year_actual, 'fm0000')        AS "Created_Year",    created_dts_calendar.year_actual                           AS "Created_YearNo",    created_dts_calendar.fiscal_year_abbr                      AS "Created_FiscalYear",    created_dts_calendar.fiscal_year_abbr::int                 AS "Created_FiscalYearNo",    date_part('hour', print_job.created_dts)::bigint                                AS "Created_HourOfDay",    hour_bin_get_bin(date_part('hour', print_job.created_dts)::integer)             AS "Created_HourBin",    hour_bin_get_bin_label(date_part('hour', print_job.created_dts)::integer)       AS "Created_HourBinName",-- Extended date/time columns: created_local_dts    created_local_dts_calendar.date_actual                      AS "Created_Date_Local",    created_local_dts_calendar.date_actual                      AS "CreatedDate_Local",    created_local_dts_calendar.date_actual                      AS "DateTime_Local", -- Consistent name for filters.    created_local_dts_calendar.day_of_week_usa                  AS "Created_DayOfWeek_Local",    created_local_dts_calendar.day_name_abbreviated             AS "Created_DayName_Local",    created_local_dts_calendar.week_of_year_fiscal_name         AS "Created_FiscalWeek_Local",   --  Week 24 2020    created_local_dts_calendar.week_of_year_fiscal              AS "Created_FiscalWeekNo_Local", --  2020-24    created_local_dts_calendar.month_actual                     AS "Created_MonthNo_Local",    created_local_dts_calendar.month_actual_name_abbreviated    AS "Created_MonthName_Local",    created_local_dts_calendar.month_fiscal                     AS "Created_FiscalMonthNo_Local",    created_local_dts_calendar.month_fiscal_name_abbreviated    AS "Created_FiscalMonthName_Local",    to_char(created_local_dts_calendar.year_actual, 'fm0000')   AS "Created_Year_Local",    created_local_dts_calendar.year_actual                      AS "Created_YearNo_Local",    created_local_dts_calendar.fiscal_year_abbr                 AS "Created_FiscalYear_Local",    created_local_dts_calendar.fiscal_year_abbr::int            AS "Created_FiscalYearNo_Local",    date_part('hour', print_job.created_local_dts)::bigint                          AS "Created_HourOfDay_Local",    hour_bin_get_bin(date_part('hour', print_job.created_local_dts)::integer)       AS "Created_HourBin_Local",    hour_bin_get_bin_label(date_part('hour', print_job.created_local_dts)::integer) AS "Created_HourBinName_Local"--  Get the data for the SELECT above    FROM print_job    LEFT JOIN hsys            ON hsys.id             =  print_job.hsys_id    LEFT JOIN facility        ON facility.id         =  print_job.facility_id    -- JOIN instead of LEFT JOIN to drop rows with invalid facility_id, invalid facility.calendar_id, or an epoch DTS.       JOIN calendar_day_plus AS created_dts_calendar         ON (created_dts_calendar.calendar_id = facility.calendar_id        AND created_dts_calendar.date_actual = date(print_job.created_dts))    -- JOIN instead of LEFT JOIN to drop rows with invalid facility_id, invalid facility.calendar_id, or an epoch DTS.       JOIN calendar_day_plus AS created_local_dts_calendar         ON (created_local_dts_calendar.calendar_id = facility.calendar_id        AND created_local_dts_calendar.date_actual = date(print_job.created_local_dts))   WHERE print_job.marked_for_deletion <> true  ;ALTER VIEW api.print_job_domo    OWNER TO user_change_structure;-------------------------------------------------- Register view------------------------------------------------CALL view_register ('api','print_job_domo','PrintJob details from multiple servers.','PROD PrintJob PG');