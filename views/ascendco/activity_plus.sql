DROP VIEW IF EXISTS ascendco.activity_plus;CREATE OR REPLACE VIEW ascendco.activity_plus ASSELECT activity.id,       coalesce(hsys.name_, 'Unknown')                         AS hsys_name,       facility.id                                             AS facility_id,       coalesce(facility.name_, 'Unknown')                     AS facility_name,       coalesce(facility_activities.name_, 'Unknown')          AS activity_name,       coalesce(data_file_info.server_name_, 'Unknown')        AS server_name,       activity.start_dts,       activity.done_dts,       activity.duration_seconds,       activity.updated_dts,       activity.marked_for_deletion,       activity.other_desc,       coalesce(web_user.name_full, 'Unknown')                 AS user_name,       activity.created_dts,       activity.created_by,       activity.updated_by--   Note: activity doesn't have hsys_id, you neeed to load facility, and get the hsys_id from there.     FROM activityLEFT JOIN facility_activities  ON facility_activities.id   = activity.facility_activities_idLEFT JOIN web_user             ON web_user.id              =  activity.web_user_idLEFT JOIN data_file_info       ON data_file_info.id        =  activity.last_updated_by_data_file_idLEFT JOIN facility             ON facility.id              =  activity.facility_idLEFT JOIN hsys                 ON hsys.id                  =  facility.hsys_id;ALTER VIEW ascendco.activity_plus    OWNER TO user_change_structure;----------------------------------------------- Register view---------------------------------------------CALL view_register ('ascendco','activity_plus','activity data, with lookup values');