-- View: passthrough.musc_orscansinout_v1DROP VIEW IF EXISTS passthrough.musc_orscansinout_v1;CREATE OR REPLACE VIEW passthrough.musc_orscansinout_v1 AS     SELECT            coalesce(hsys.name_,'') as "HsysName",            coalesce(facility.name_,'') as "FacilityName",            expanded_data."Event" AS "Event",            expanded_data."Scan_DayName" AS "Scan_DayName",            expanded_data."Scan_Date" AS "Scan_Date",            expanded_data."scannedType" AS "scannedType",            expanded_data."scannedDesc" AS "scannedDesc",            expanded_data."locationDesc" AS "locationDesc",            expanded_data."scannedDTS" AS "scannedDTS",            expanded_data."scannedBy" AS "scannedBy",            expanded_data."state" AS "state",            expanded_data."substate" AS "substate",            expanded_data."scannedAt" AS "scannedAt",            expanded_data."Scan_Local" AS "Scan_Local",            expanded_data."ScanDTS" AS "ScanDTS",            expanded_data."timezone" AS "timezone",            expanded_data."Specialty" AS "Specialty",            expanded_data."ClinicDeptName" AS "ClinicDeptName",            expanded_data."ItemType" AS "ItemType",            expanded_data."Category" AS "Category",            expanded_data."ItemName" AS "ItemName",            expanded_data."InvName" AS "InvName",            expanded_data."NumInst" AS "NumInst",            expanded_data."Scan_HourOfDay" AS "Scan_HourOfDay",            expanded_data."Scan_HourBin" AS "Scan_HourBin",            expanded_data."Scan_DayOfWeek" AS "Scan_DayOfWeek",            expanded_data."scanID" AS "scanID"       FROM domo_passthrough  LEFT JOIN facility on (domo_passthrough.facility_id = facility.id)  LEFT JOIN hsys     on (domo_passthrough.hsys_id = hsys.id)CROSS JOIN jsonb_to_recordset(domo_passthrough.data) as expanded_data (            "Event" citext,            "Scan_DayName" citext,            "Scan_Date" date,            "scannedType" citext,            "scannedDesc" citext,            "locationDesc" citext,            "scannedDTS" timestamp,            "scannedBy" citext,            "state" citext,            "substate" citext,            "scannedAt" timestamp,            "Scan_Local" timestamp,            "ScanDTS" timestamp,            "timezone" citext,            "Specialty" citext,            "ClinicDeptName" citext,            "ItemType" citext,            "Category" citext,            "ItemName" citext,            "InvName" citext,            "NumInst" int4,            "Scan_HourOfDay" int4,            "Scan_HourBin" int4,            "Scan_DayOfWeek" int4,            "scanID" uuid)    WHERE dataset_name = 'MUSC_OrScansInOut_PG' AND          view_version = 1; -- Important! The view knows how to parse out JSONB data packed in this way.ALTER TABLE passthrough.musc_orscansinout_v1    OWNER TO user_change_structure;----------------------------------------------- Register view---------------------------------------------CALL view_register ('passthrough','musc_orscansinout_v1','','MUSC_ORScansInOut_PG');