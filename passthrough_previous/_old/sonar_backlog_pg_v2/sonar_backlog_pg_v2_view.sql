/* The Domo SELECT for this is:SELECT * from sonar_backlog_pg_v2;If you have mutiple version for this DataSet in the domo_passthrough table at once,then the Domo SELECT needs to use UNION to combine the results.*/-- View: passthrough.sonar_backlog_pg_v2DROP VIEW IF EXISTS passthrough.sonar_backlog_pg_v2;CREATE OR REPLACE VIEW passthrough.sonar_backlog_pg_v2 AS     SELECT             coalesce(hsys.name_,'') as "HsysName",            coalesce(facility.name_,'') as "FacilityName",            expanded_data."Backlog_Date" AS "Backlog_Date",            expanded_data."Backlog_DayName" AS "Backlog_DayName",            expanded_data."Backlog_DayOfWeek" AS "Backlog_DayOfWeek",            expanded_data."Backlog_HourBin" AS "Backlog_HourBin",            expanded_data."Backlog_HourOfDay" AS "Backlog_HourOfDay",            expanded_data."Backlog_Local" AS "Backlog_Local",            expanded_data."Backlog_Month" AS "Backlog_Month",            expanded_data."Backlog_MonthNo" AS "Backlog_MonthNo",            expanded_data."Backlog_Year" AS "Backlog_Year",            expanded_data."Backlog_YearNo" AS "Backlog_YearNo",            expanded_data."BacklogDTS" AS "BacklogDTS",            expanded_data."CleanBacklog" AS "CleanBacklog",            expanded_data."CleanInstBacklog" AS "CleanInstBacklog",            expanded_data."DateHour" AS "DateHour",            expanded_data."DateTime" AS "DateTime",            expanded_data."DirtyBacklog" AS "DirtyBacklog",            expanded_data."DirtyInstBacklog" AS "DirtyInstBacklog",            expanded_data."FacilityID" AS "FacilityID",            expanded_data."OverallBacklog" AS "OverallBacklog",            expanded_data."OverallInstBacklog" AS "OverallInstBacklog"                FROM domo_passthrough  LEFT JOIN facility on (domo_passthrough.facility_id = facility.id)  LEFT JOIN hsys     on (domo_passthrough.hsys_id = hsys.id)CROSS JOIN jsonb_to_recordset(domo_passthrough.data) as expanded_data (            "Backlog_Date" date,            "Backlog_DayName" citext,            "Backlog_DayOfWeek" int4,            "Backlog_HourBin" int4,            "Backlog_HourOfDay" int4,            "Backlog_Local" citext,            "Backlog_Month" citext,            "Backlog_MonthNo" int4,            "Backlog_Year" citext,            "Backlog_YearNo" int4,            "BacklogDTS" timestamp,            "CleanBacklog" int4,            "CleanInstBacklog" int4,            "DateHour" citext,            "DateTime" citext,            "DirtyBacklog" int4,            "DirtyInstBacklog" int4,            "FacilityID" uuid,            "OverallBacklog" int4,            "OverallInstBacklog" int4)           WHERE dataset_name = 'Sonar_Backlog_PG' AND          view_version = 2; -- Important! The view knows how to parse out JSONB data packed in this way.ALTER TABLE passthrough.sonar_backlog_pg_v2    OWNER TO user_change_structure;    -----------------------------------------------Register view---------------------------------------------CALL view_register ('passthrough','sonar_backlog_pg_v2','','Sonar_Backlog_PG');